\section{Δημοσίευση πακέτου \texttt{HierarchicalTemporalMemory.jl}}

	Στο πλαίσιο αυτής της εργασίας, ακολουθώντας την υλοποίηση του κεφαλαίου \ref{impl} και επαυξάνοντας πάνω σε αυτήν,
	δημιουργήθηκε πακέτο Julia που υλοποιεί τους 2 αλγορίθμους HTM που περιγράφηκαν.
	Δημοσιεύεται ως ελεύθερο λογισμικό \parencite{stallmanFreeSoftwareFree2002} στο Github\footnote{Ημερομηνία δημοσίευσης: 2019/06/09}:
	\url{https://github.com/Oblynx/HierarchicalTemporalMemory.jl}

	Η ανάπτυξη θα συνεχιστεί πέρα από το πλαίσιο αυτής της εργασίας.

\subsection{Συνεισφορές στο οικοσύστημα της Julia («upstream»)}

	\subsubsection{Διόρθωση στον πολλαπλασιασμό αραιού πίνακα με διάνυσμα}

	Η υλοποίηση της χρονικής μνήμης βασίστηκε στους αραιούς πίνακες.
	Η υποστήριξη των αραιών πινάκων στη Julia, αν και επαρκής για βασική χρήση, αφήνει μερικά κενά.
	Ένα τέτοιο διαπιστώθηκε κατά την εκπόνηση αυτής της εργασίας.

	Έστω αραιός πίνακας με τιμές Bool, \texttt{S::SparseMatrixCSC{Bool}},
	και πυκνό διάνυσμα Bool, \texttt{a::Vector{Bool}}.
	Ενώ εν γένει ο πολλαπλασιασμός αραιού πίνακα με πυκνό διάνυσμα υποστηρίζεται, αυτός ο συγκεκριμένος συνδυασμός τύπων δημιουργούσε πρόβλημα.
	Ο πολλαπλασιασμός κατά προεπιλογή πραγματοποιείται στον ημιδακτύλιο (+,*).
	Οι τελεστές αυτοί δεν έχουν ειδικό νόημα για τιμές Bool: \texttt{Bool + Bool} προκαλεί μετατροπή των ορισμάτων σε \texttt{Int} και εκτελεί εν τέλει \texttt{Int(Bool) + Int(Bool)}
	\footnote{ Δεν είναι δύσκολο να οριστεί ο πολλαπλασιασμός του αραιού πίνακα με το διάνυσμα σε διαφορετικό ημιδακτύλιο, πχ (max,min) --
	για την ακρίβεια αυτό ακριβώς παρουσιάζεται στο \cite{shahNovelAlgebrasAdvanced2013}, όπου δείχνεται ότι, για αραιούς πίνακες,
	η υλοποίηση από το χρήστη είναι πέρα από εύκολη και \textbf{εξίσου αποδοτική με τον τυπικό πολλαπλασιασμό που ορίζουν οι βασικές βιβλιοθήκες της γλώσσας} }.
	Επειδή και ο πίνακας και το διάνυσμα που συμμετέχουν στον πολλαπλασιασμό έχουν τύπο στοιχείου Bool,
	η συνάρτηση του πολλαπλασιασμού εσφαλμένα απέδιδε στο αποτέλεσμα τύπο στοιχείου Bool.
	Το επακόλουθο ήταν ο πολλαπλασιασμός $S*a$ να προκαλεί σφάλμα.
	Η προφανής επίλυση είναι η αλλαγή του τύπου του αποτελέσματος σε αυτό που προκύπτει από τις πράξεις μεταξύ των στοιχείων των ορισμάτων, εδώ \texttt{Int}.

	Καθώς η Julia αναπτύσσεται ως ελεύθερο λογισμικό, κατέστη εφικτό στο πλαίσιο αυτής της εργασίας να διορθωθεί αυτό το σφάλμα στην πηγή του.
	Η διόρθωση υποβλήθηκε ως «pull request» \footnote{\url{https://github.com/JuliaLang/julia/pull/32082}} και έγινε δεκτή.

	\subsubsection{Διόρθωση στο χειρισμό Unicode στο \texttt{Weave.jl}}

	Το κεφάλαιο \ref{impl} αυτής της αναφοράς συγγράφηκε με τη μεθοδολογία \textbf{«literate programming»} \parencite{knuthLiterateProgramming1984},
	που εμπλέκει λειτουργικό κώδικα και αφηγηματικό κείμενο,
	χρησιμοποιώντας το πακέτο της Julia \texttt{Weave.jl} \cite{pastellWeaveJlScientific2017}.
	Έγινε εκτενής χρήση χαρακτήρων Unicode που υποστηρίζονται από τη Julia, τόσο στο κείμενο όσο και στον κώδικα.
	Οι χαρακτήρες Unicode κωδικοποιούνται υπό το πρότυπο UTF-8, μια κωδικοποίηση μεταβλητού μήκους.

	Κατά τη δημιουργία της αναφοράς παρατηρήθηκε πρόβλημα στον τρόπο με τον οποίο το Weave.jl ερμήνευε τους χαρακτήρες Unicode.
	Από εκφράσεις με πολύ ειδικούς χαρακτήρες έλειπε το τελευταίο τμήμα.
	Διαπιστώθηκε λοιπόν ότι κατά την ανάγνωση του κειμένου το \texttt{Weave.jl} δε λάμβανε υπόψιν το μεταβλητό μήκος των χαρακτήρων UTF-8,
	θεωρώντας εσφαλμένα ότι κάθε χαρακτήρας έχει το ίδιο μήκος.
	Καθώς και αυτό είναι ανοιχτό λογισμικό, το σφάλμα επίσης διορθώθηκε στην πηγή του
	\footnote{\url{https://github.com/mpastell/Weave.jl/pull/215}}.
	Κατά τη συγγραφή αυτής της αναφοράς η αποδοχή της διόρθωσης εκκρεμεί.

\subsection{Παράδειγμα πρόβλεψης ακολουθίας} \label{conc:intro-tspred}

	Το πακέτο συμπεριλαμβάνει μία απλή εφαρμογή πρόβλεψης ακολουθίας, που χρησιμοποιήθηκε ως βασικός έλεγχος ορθότητας της υλοποίησης.
	Επομένως περιέχει τα υπόλοιπα στοιχεία που χρειάζεται ένα σύστημα πρόβλεψης με HTM και φαίνονται στο σχήμα (\ref{fig:sp}, πάνω):
	έναν κωδικοποιητή κι έναν αποκωδικοποιητή/κατηγοριοποιητή.

	\subsubsection{Κωδικοποιητής «απλός αριθμητικός»}

	Ο κωδικοποιητής αναπαριστά πραγματικούς αριθμούς φραγμένους σε ένα εύρος, δημιουργώντας SDR με μήκος N και πληθάριθμο w.
	Ο ελάχιστος αριθμός του εύρους αναπαρίσταται με το SDR που έχει τα w πρώτα bits ενεργά, αντίστοιχα ο μέγιστος έχει τα w τελευταία ενεργά.
	Κάθε ενδιάμεσος αριθμός αντιστοιχίζεται σε ένα ισοκατανεμημένο φάσμα μεταξύ των δύο ακραίων αναπαραστάσεων,
	ορίζοντας ουσιαστικά ένα σύνολο κλάσεων που διακριτοποιούν την είσοδο.
	Ο κωδικοποιητής αυτός ονομάζετα «απλός αριθμητικός».

	Η \textit{συγκόλληση k SDR στη σειρά} για μικρό k (πχ 2-7) είναι επαρκής τρόπος για τη συνδυασμένη αναπαράσταση k εισόδων.
	Οι διακριτές είσοδοι που συνδυάζονται με αυτήν την απλή λογική δεν μπορούν να είναι οσοδήποτε πολλές,
	γιατί η διάσταση του χώρου της εισόδου θα αυξηθεί πολύ πιο γρήγορα από την αύξηση της πληροφορίας που φέρει,
	δυσχεραίνοντας την αναγνώριση παρόμοιων εισόδων.
	Στο συνδυασμό πολλών εισόδων το κλειδί ενδέχεται να είναι η ιεραρχικη οργάνωση πολλών μονάδων HTM,
	που θα αναλυθεί στις προτάσεις για μελέτη \ref{conc:study-suggestions}.

	\subsubsection{Αποκωδικοποιητής «SDR classifier»}

	Ο αποκωδικοποιητής, που ονομάζεται «SDR classifier» \parencite{cuiContinuousOnlineSequence2016},
	βασίζεται στην παρατήρηση ότι η δραστηριότητα της χρονικής μνήμης είναι η απεικόνιση ενός συμβόλου-εισόδου στο πλαίσιο των χρονικών του συμφραζομένων.
	Ο αποκωδικοποιητής που χρησιμοποιείται εδώ είναι ένα απλό ενός επιπέδου perceptron πολλών κλάσεων που μαθαίνει να συσχετίζει
	τη δραστηριότητα της χρονικής μνήμης με τις εισόδους του κωδικοποιητή.
	Η είσοδος είναι το διάνυσμα $Π$ των προβλέψεων της χρονικής μνήμης κι η έξοδος, κατανομή πιθανότητας πάνω στις κλάσεις του κωδικοποιητή.

	Έστω ο αποκωδικοποιητής $D$ καλείται να αποκωδικοποιήσει την πρόβλεψη $Π_t$, επιστρέφοντας
	$D(Π_t)$.
	Έστω επίσης ότι η πρόβλεψη αφορά την τιμή της εισόδου $k$ χρονικές στιγμές στο μέλλον,
	$u_{t+k}$.
	Τη στιγμή $t+k$, ο αποκωδικοποιητής θα χρησιμοποιήσει το σφάλμα $e_{t+k} = D(Π_t) - u_{t+k}$
	για να τροποποιήσει τον πίνακα βαρών $W$ του δικτύου του κατά
	$$ ΔW= -α .* e_{t+k}*Π[Π]' $$

	Για την ερμηνεία της κατανομής πιθανότητας στις κλάσεις του κωδικοποιητή απαιτείται και ένας μηχανισμός αποσαφήνισης.
	Παρέχονται 3 τέτοιοι: πιθανότερο ενδεχόμενο, μέσος όρος, μέσος όρος των πιθανότερων ενδεχομένων.


\section{Επαλήθευση βασικών ιδιοτήτων των αλγορίθμων}

\subsection{Περιγραφή συνόλου δεδομένων} \label{conc:tspred-dataset}

	Το σύνολο δεδομένων που χρησιμοποιήθηκε για τους ελέγχους που ακολουθούν βρίσκεται στο \url{https://github.com/numenta/nupic/blob/master/examples/opf/clients/hotgym/prediction/one_gym/rec-center-hourly.csv}.
	Το συγκεκριμένο σύνολο δεδομένων προτιμήθηκε καθώς αποτελεί παράδειγμα αναφοράς για την ικανότητα πρόβλεψης στους αλγορίθμους HTM
	και χρησιμοποιείται για την επίδειξη της πρότυπης υλοποίησης, του NuPIC, στο 	\parencite{numentaNuPICHotGymPrediction2019}.
	Κάθε στοιχείο αποτελείται από το χρόνο καταγραφής (ημερομηνία, ώρα) και την κατανάλωση ισχύος του γυμναστηρίου σε kW.
	Επιλέγεται ένα υποσύνολο των μισών περίπου δεδομένων για αυτά τα πειράματα, μεταξύ των ημερομηνιών \texttt{07/06/0010 00:00}
	και \texttt{10/14/0010 23:00}, που περιέχει δύο σχετικά στάσιμες περιόδους κατανάλωσης με μια μικρή διαφορά στη μέση τιμή της κατανάλωσης μεταξύ τους.

	Το σύνολο δεδομένων (σχήμα \ref{fig:tshotgym}) εμφανίζει ενδιαφέροντα χαρακτηριστικά για πρόβλημα πρόβλεψης.
	Αφενός, έχει μία \textit{κανονικότητα} που εκφράζεται σε δύο διαφορετικές χρονικές κλίμακες: \textit{ημερήσια και εβδομαδιαία περιοδικότητα}
	(γιατί η κατανάλωση ισχύος τείνει να είναι διαφορετική τα Σαββατοκύριακα).
	Επομένως, ένα επιτυχημένο μοντέλο πρόβλεψης καλείται να εντοπίσει τα μοτίβα \textbf{και στις δύο χρονικές κλίμακες ταυτόχρονα}.
	Επίσης, εμφανίζει \textit{σποραδικά ακραία φαινόμενα}, που θα χρησίμευαν και για έλεγχο της ικανότητας πρόβλεψης ανωμαλιών.
	Τέλος, \textit{δεν είναι στάσιμο}, αφού λίγο μετά το μισό χρόνο η μέση τιμή της χρονοσειράς μεταβάλλεται.
	Ένα επιτυχημένο μοντέλο πρόβλεψης καλείται επομένως \textbf{να προσαρμοστεί σε αυτήν την αλλαγή}.

	\begin{figure}
		\centering
		\includesvg[width=\textwidth]{figures/tshotgym}
		\caption[χρονοσειρά κατανάλωσης ισχύος για πείραμα πρόβλεψης]{Χρονοσειρά εισόδου στον έλεγχο του χωρικού συγκεντρωτή και της χρονικής μνήμης, στην οποία επιχειρείται πρόβλεψη 1 βήματος.
		Εκφράζει την ωριαία κατανάλωση ισχύος ενός Αυστραλιανού γυμναστηρίου.
		Εμφανίζει ταυτόχρονα \textit{ημερήσια και εβδομαδιαία περιοδικότητα}, αλλά επίσης εμφανίζει
		\textit{απρόβλεπτες ακραίες τιμές} και \textit{αλλαγή της μέσης τιμής}.
		Πηγή: \url{https://github.com/numenta/nupic/blob/master/examples/opf/clients/hotgym/prediction/one_gym/rec-center-hourly.csv}}
		\label{fig:tshotgym}
	\end{figure}

\subsection{Διατήρηση σημασιολογικής ομοιότητας στο χωρικό συγκεντρωτή} \label{conc:sp-simil}

	Όπως περιγράφηκε στην ενότητα \ref{htm:sp}, αρχή λειτουργίας του χωρικού συγκεντρωτή είναι η διατήρηση της ομοιότητας των εισόδων στις εξόδους του.
	Δηλαδή, είσοδοι που μοιάζουν πολύ πρέπει να οδηγούν σε εξόδους που μοιάζουν πολύ και αντιστρόφως.

	Έστω 3 είσοδοι $x_1, x_2, x_3$ κι οι αντίστοιχες έξοδοι $y_1, y_2, y_3$
	και «overlap score» (βλέπε \ref{htm:sdr}) $\mathit{sx}_{i,j}= ||x_i ∩ x_j||$, $\mathit{sy}_{i,j}= ||y_i ∩ y_j||$,

	Έστω $\mathit{sx}_{1,2} >> \mathit{sx}_{1,3}$.
	Τότε θα πρέπει και $\mathit{sy}_{1,2} >> \mathit{sy}_{1,3}$.

	Αυτή η ιδιότητα εξετάζεται στο \texttt{HierarchicalTemporalMemory.jl} ως τεκμήριο υπεράσπισης της ορθότητας της υλοποίησης.
	Δημιουργείται χωρικός συγκεντρωτής που παρακολουθεί και μαθαίνει να αναπαριστά τη χρονοσειρά που περιγράφηκε στο \ref{conc:tspred-dataset}.
	Τα δεδομένα αποτελούνται από 3 πεδία για κάθε χρονική στιγμή:
	\begin{itemize}
		\item κατανάλωση ισχύος
		\item ημερομηνία και ώρα
		\item αν είναι Σαββατοκύριακο
	\end{itemize}

	Κάθε πεδίο κωδικοποιείται από έναν «απλό αριθμητικό» κωδικοποιητή (όπως περιγράφηκε στο \ref{conc:intro-tspred}) και τα 3 SDR συγκολλούνται μαζί,
	για να δημιουργήσουν την είσοδο του χωρικού συγκεντρωτή.
	Το μέγεθος της εισόδου του συγκεντρωτή είναι 600, ενώ το μέγεθος της εξόδου 2048.
	Και οι δύο χώροι είναι μονοδιάστατοι χωρίς τοπολογία.

	Ο χωρικός συγκεντρωτής ρυθμίζεται με ολική αναστολή (χωρίς τοπολογία, η τοπική αναστολή δεν έχει νόημα)
	και κάθε μικροστήλη του προβάλλει εν δυνάμει πάνω σε ολόκληρο το χώρο εισόδου ($γ>600$).
	Η αραιότητα εξόδου είναι $s=2\%$, η προσαρμογή των συνάψεων γίνεται με $p⁺= 0.07,p⁻= 0.12$.
	Η παρώθηση εφαρμόζεται με βάρος $β=3$ και χρονική σταθερά $Tboost=400$, δηλαδή λίγο μεγαλύτερη από 2 εβδομάδες.
	Υλοποιείται έτσι ένα μέρος από το πλήρες σύστημα πρόβλεψης HTM που φαίνεται στο σχήμα (\ref{fig:sp} πάνω): ο κωδικοποιητής και ο χωρικός συγκεντρωτής.

	Με αυτές τις ρυθμίσεις, το σύστημα του κωδικοποιητή και του χωρικού συγκεντρωτή επεξεργάζονται βήμα βήμα τη χρονοσειρά εισόδου.
	Κάθε στιγμή αποθηκεύεται το SDR εισόδου και το SDR εξόδου του συγκεντρωτή.
	Αναζητούνται σε όλη την έως τώρα ιστορία να βρεθούν τα SDR που «ταιριάζουν» περισσότερο με τα τρέχοντα,
	δηλαδή οι πιο όμοιες κωδικοποιήσεις και έξοδοι ως τώρα.
	Κρατείται το 10\% των πιο ταιριαστών SDR.
	Αν η αρχή λειτουργίας του χωρικού συγκεντρωτή ικανοποιείται πλήρως,
	αναμένουμε τα δύο σύνολα να έχουν πλήρη επικάλυψη:
	τα 10 SDR που ταιριάζουν περισσότερο με την τρέχουσα κωδικοποίηση πρέπει να είναι των ιδίων χρονικών στιγμών
	με τα 10 SDR που ταιριάζουν περισσότερο με την τρέχουσα έξοδο του συγκεντρωτή.

	Τα αποτελέσματα του πειράματος φαίνονται στο σχήμα \ref{fig:sp_maintain_similarity}.
	Ο χωρικός συγκεντρωτής \textit{επιτυγχάνει να ικανοποιήσει την αρχή λειτουργίας του κατά 85\% },
	σύμφωνα με τον ορισμό του μέτρου που περιγράφεται στο σχήμα.


	\begin{figure}[t]
		\centering
		\includegraphics[width=\textwidth]{figures/sp1.eps}
		\includegraphics[width=\textwidth]{figures/sp2.eps}
		\caption[]{Μελέτη διατήρησης ομοιότητας του χώρου εισόδου από το χωρικό συγκεντρωτή
		-- αμέσως πριν και μετά την αλλαγή μέσης τιμής της χρονοσειράς}
	\end{figure}
	\begin{figure}[t]\ContinuedFloat
		\includegraphics[width=\textwidth]{figures/sp3.eps}

		\captionsetup{singlelinecheck=off}
		\caption[μελέτη διατήρησης ομοιότητας του χώρου εισόδου από το χωρικό συγκεντρωτή]{%
			Μελέτη διατήρησης ομοιότητας από το χώρο εισόδου στο χώρο εξόδου διαμέσου του χωρικού συγκεντρωτή. Αυτή είναι βασική αρχή λειτουργίας του χωρικού συγκεντρωτή
			και η απόδειξη της σχετικής της ισχύος χρησιμεύει τόσο ως τεκμήριο ορθότητας της υλοποίησης,
			όσο και του αλγορίθμου γενικότερα.
			Χρησιμοποιείται η χρονοσειρά που περιγράφεται στο \ref{conc:tspred-dataset}.

			Παρουσιάζονται 3 στιγμιότυπα: αμέσως πριν και αμέσως μετά την αλλαγή της μέσης τιμής της χρονοσειράς και στο τέλος.
			Για κάθε στιγμιότυπο υπάρχουν 2 γραφήματα.

			Στο πάνω φαίνεται η χρονοσειρά και επισημαίνονται τα πιο ταιριαστά ως τώρα SDR με την τρέχουσα στιγμή:
			{\color{red} είσοδοι που δεν ταιριάζουν πολύ με την τωρινή έξοδο},
			{\color{green} έξοδοι που δεν ταιριάζουν πολύ με την τωρινή είσοδο},
			{\color{magenta} είσοδοι και έξοδοι που ταιριάζουν με τις τωρινές}.

			Στο κάτω φαίνεται το ποσοστό των εισόδων/εξόδων που ταιριάζουν. Χρησιμεύει ως μέτρο επίδοσης του χωρικού συγκεντρωτή.

			Φαίνεται πως η αλλαγή της μέσης τιμής έχει αμελητέα επίδραση στην επίδοση του χωρικού συγκεντρωτή.
			Καθώς το πείραμα εξελίσσεται το μέτρο επίδοσης γίνεται πιο εύρωστο, καθώς προκύπτει από περισσότερα SDR.
			Αυτός είναι ο κύριος λόγος που μειώνεται η διακύμανση.
		}
		\label{fig:sp_maintain_similarity}
	\end{figure}

\subsection{Πρόβλεψη χρονοσειράς με τη χρονική μνήμη} \label{conc:tm-pred}

	Για την εξέταση της χρονικής μνήμης εκτελέστηκε ένα πείραμα πρόβλεψης χρονοσειράς.
	Χρησιμοποιήθηκαν τα ίδια δεδομένα, που περιγράφηκαν στο \ref{conc:tspred-dataset}.

	Κατασκευάστηκε ένα πλήρες σύστημα πρόβλεψης HTM με κωδικοποιητή, χωρικό συγκεντρωτή, χρονική μνήμη και αποκωδικοποιητή,
	όπως περιγράφεται στο σχήμα (\ref{fig:sp} πάνω).
	Ο χώρος εισόδου (μέγεθος κωδικοποιητή) είναι ίδιος με το \ref{conc:sp-simil}.
	Ο χωρικός συγκεντρωτής έχει λιγότερες μικροστήλες από πριν, 1600, με 8 νευρώνες ανά μικροστήλη.
	Οι παράμετροι του χωρικού συγκεντρωτή είναι ίδιες, εκτός από την αραιότητα εξόδου που είναι διπλάσια, στο $s=4\%$.

	


\section{Τι αξίζει να μελετηθεί στην HTM;} \label{conc:study-suggestions}
